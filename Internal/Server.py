from datetime import datetime


sessionServer = 'iaimz014.informatik.uni-mainz.de'
listenPort = 55555

tcpServer = None

sessionProtocolVersion = 5

test               = set()
joiningClients     = set()
openSessions       = dict() # maps session id to session
activeSessions     = dict() # maps session id to session
unvalidatedSockets = set()
validatedSockets   = set()
controlHandlers    = set()
blockedAddresses   = dict() # maps address to remaining trial count
fileHashDict       = dict()

cacheFolder = 'GameSessionServerCache'

logFile = 'GameSessionServer.log'


# 9 bytes at maximum
sessionClientSecret = b'\xA3\xC7\x9C\xF9\x2E\x0D\x30\x11'


# certificate and key generated by
#   openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -subj /CN=localhost -nodes -days 10000
# and base64 encoded by
#   cat ... | base64 -w100 | sed "s/.*/    '\0'\\\/"

certificate = \
    'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZDVENDQXZHZ0F3SUJBZ0lVV2kxdUhiVHVwQzA5Rjcwb091UDZPdUFGdFJZ'\
    'd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0ZERVNNQkFHQTFVRUF3d0piRzlqWVd4b2IzTjBNQjRYRFRFNU1UQXdOekEwTURJMU5sb1hE'\
    'VFEzTURJeQpNakEwTURJMU5sb3dGREVTTUJBR0ExVUVBd3dKYkc5allXeG9iM04wTUlJQ0lqQU5CZ2txaGtpRzl3MEJBUUVGCkFB'\
    'T0NBZzhBTUlJQ0NnS0NBZ0VBdXUvUVhtREFzd0NYeUxWaFBqeTFRTjgyOHpHa1FTb1d4eFdTTVgxaThvUGcKcFdQQlROOHhENGcw'\
    'OW1FOFBRSWZ3bkN2K1RJdmlvYUkydDlONjhTWUVseWZUOUlkSDdpQmZSN01ObzI1U2xKZgo4amRudzZvR1JDWUZ3KzFWcnlzcVJi'\
    'bmZ5MjNDc3NVK0JFb0YzcWhaR1k1M0prUGU3Tm1uWEJiLzNvTDljcjl5CldHWWVDUmxmaW1lRmZEYm1GR1dLNnROeGR5L2pnMHAw'\
    'YUJxS25McGh6VDBveVpmOFBUanM5anRwVWtQT0hwMWQKcnhWT2xFazZYNGVLN2tmRDA5V2l5bkxCUWcyNktZSGYrQmNuTmVlYThK'\
    'R0wxQnZNZ2FYWkkyYU1rRUVDeUd0MQpiVk5COW1MMGI2di8zcEd1ZE84TXdKUXowVnlzMDM4TVB6Z0k2Wkh4WDcrVGl1d0UrRFZK'\
    'LytUSmJFQVdDQ3BDCnA1R2YwUzh0UXhFWWE4MTdDQmtMaEJQYUtVaUplVFJUR3RlRjRYOWNxVzQyTFBZZjVuc2dENHgzYUl4Q1Vt'\
    'c2oKcmtGSkQ2WVJrbjVXQi93NjVZSVU3OGEwUjd1TEdoQlUyU2l0L2lLaktIUkMvRUM1blp1RmFjNjc3SUNTaGh5RQpocndUeTMx'\
    'THQ4elUvK3gzeGZqRVBSTUpOWFhuR2FPTXc3KzRpR3JhSmNaYzlDaW1MamJ4QTdFL29MS3hOSDJECmQ4MmcycTBjU2NSUHJVQ0U0'\
    'ZDI2LzZqdWJucHVmVktiNWh6V0p2YUpDUUU2VGNwc2l4c1FoejcrR3JjbnQ3VWEKV292bFhjbTFabGlTRS90ZU9penkwaG5DKzk0'\
    'dDNsdG9QN2s1bzdGRjBpNnp3Mkdmb2MzZFBlbkVvV2l5VW44QwpBd0VBQWFOVE1GRXdIUVlEVlIwT0JCWUVGRWkzeTlQQmZERHZQ'\
    'RGhkZ3dwSmxNRHdyb3daTUI4R0ExVWRJd1FZCk1CYUFGRWkzeTlQQmZERHZQRGhkZ3dwSmxNRHdyb3daTUE4R0ExVWRFd0VCL3dR'\
    'Rk1BTUJBZjh3RFFZSktvWkkKaHZjTkFRRUxCUUFEZ2dJQkFJMHl1WnJwcm9VeFphR1dMeTFJelRrZWNBbTc2bE5zbndmVUNOVGlj'\
    'eER0Q0lveQpHSXpWc2dVM01hdXIxUDNlOWRpQnhOc2R5S2d2bWRlN01ZZUF5UjllTEJ4UlQ5a1pXa2ZCTWwvbFJ3dHdiS3NJClBZ'\
    'TnpiWWxrRlFuWUtDRWpKd3QyVThQRmlHUWJJRzQzTk52R0F4ZFZweStZMzY4d1crZW5ybXVickNZNEpzVWMKdFN5VXc4OSs5SEc0'\
    'Tis5VlVzVVJoa2FUcERhMDlybjErN0Q0VVpINFEvQ0hXeThGTmZ4Sko2VnZsWmFIQmRjcApoSDZkTEZ3dFhHMWJKcGs1eUJvTGtI'\
    'OGNIYWs1WndudTV1V2tBMlhUclRuWkFSYXA1OFZkbUdqRmpKOWEwSWtoCjYxejkvSXR4Mms2WkJyVHdOK0ttYmtuMVpkdXpFVlFt'\
    'UEdlU1lubHgrQWRKS01SeEcrVXIzZ08xUzkyS1ZZeFIKaVJlcUJjNDVpa2JWbTVYUHRjdWV2Zk93MDlxWHFmMncxdVZKWS9iM0ty'\
    'b2ZCSG5RMnYxaENaZWlsZ0NEZUFJSQpXWVVBeFA3WU1wSWQ3NkRvVGNmWW5pOGRWTmw4b3ViY2NwNVk4WFpMUWN1NktmQ1docUFl'\
    'YUdXbVM3S1RNdzA4CmdjTElPY1hyeHhwS3NMenFhNlFucFZTSWRYeGZhcmppZnQrWTd5b3AwclZ3b3FPcmFtSmwwdU1CYWh4NVZt'\
    'WWcKWUh6RGdmSXYyME5Ob1FpMVJOV0dsRmtVeWtzMFpCUWQ4anA3NTdiZHhLT0ZFc3Q1WGYyb2RXSlUrb3B3dkxveQpSWXhHUkNB'\
    'anQ5YVdnYW9TU0dEWVZMa2tNelhQcnpKV2s3Mm03WUgvemtMQlM5QnpzYVBrMEN1Q2FOd3gKLS0tLS1FTkQgQ0VSVElGSUNBVEUt'\
    'LS0tLQo='\

privatekey = \
    'LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9J' \
    'Q0FRQzY3OUJlWU1DekFKZkkKdFdFK1BMVkEzemJ6TWFSQktoYkhGWkl4ZldMeWcrQ2xZOEZNM3pFUGlEVDJZVHc5QWgvQ2NLLzVN' \
    'aStLaG9qYQozMDNyeEpnU1hKOVAwaDBmdUlGOUhzdzJqYmxLVWwveU4yZkRxZ1pFSmdYRDdWV3ZLeXBGdWQvTGJjS3l4VDRFClNn' \
    'WGVxRmtaam5jbVE5N3MyYWRjRnYvZWd2MXl2M0pZWmg0SkdWK0taNFY4TnVZVVpZcnEwM0YzTCtPRFNuUm8KR29xY3VtSE5QU2pK' \
    'bC93OU9PejJPMmxTUTg0ZW5WMnZGVTZVU1RwZmg0cnVSOFBUMWFMS2NzRkNEYm9wZ2QvNApGeWMxNTVyd2tZdlVHOHlCcGRralpv' \
    'eVFRUUxJYTNWdFUwSDJZdlJ2cS8vZWthNTA3d3pBbERQUlhLelRmd3cvCk9BanBrZkZmdjVPSzdBVDROVW4vNU1sc1FCWUlLa0tu' \
    'a1ovUkx5MURFUmhyelhzSUdRdUVFOW9wU0lsNU5GTWEKMTRYaGYxeXBiallzOWgvbWV5QVBqSGRvakVKU2F5T3VRVWtQcGhHU2Zs' \
    'WUgvRHJsZ2hUdnhyUkh1NHNhRUZUWgpLSzMrSXFNb2RFTDhRTG1kbTRWcHpydnNnSktHSElTR3ZCUExmVXUzek5ULzdIZkYrTVE5' \
    'RXdrMWRlY1pvNHpECnY3aUlhdG9seGx6MEtLWXVOdkVEc1QrZ3NyRTBmWU4zemFEYXJSeEp4RSt0UUlUaDNici9xTzV1ZW01OVVw' \
    'dm0KSE5ZbTlva0pBVHBOeW15TEd4Q0hQdjRhdHllM3RScGFpK1ZkeWJWbVdKSVQrMTQ2TFBMU0djTDczaTNlVzJnLwp1VG1qc1VY' \
    'U0xyUERZWitoemQwOTZjU2hhTEpTZndJREFRQUJBb0lDQVFDNnlSemU4TFliSmlDRHdCaW1ZMnFJCm80RDRoMFdraHpXelAyNlFY' \
    'TVVkcFlBMlFmTEhxTXdReFB5R29xbmFHK0U0Ry9qNWVwZmVSb2RBaTVnRVdLL0sKeVJtMlhEQVZuZnBrMXYwZUZZWnJLTndOM2lh' \
    'a2I2TkxQT0xOM3J1YkIvcDVLVHpndTQrcnFVSktidHhtbXJoTQp2UGw1RnFBTThYNDBtaGFZY3pKa0ViOWpiTVhlT2FncFZ6OGQy' \
    'bzBUSEZNdVNKQTdrM0kxb1pPbTRiNVcxRFVkCktsc3k4OVpxSmhOQUJpVTZ1ZDJlNFliV2h1ZTVhMklVU2c4Y0FFRS96VnVZQmdu' \
    'c3dtS2RUdFJIeEhxOWRlcHYKTGo4VmRhRm1laHo1TG1LTlVTaENzbnptL0NZUTF0ZC9MZEhBeHJnV3h6VnF4NnJ2S3piVkxVRkRl' \
    'ZTROMUhIawpqN3NDbnZnNmNxMFZlbVZmVENzRGZibW5zUFY0VmV3RWdHTjBiV2M3alprK0hwTERrUmt2d1FIMzZpV0JNQWNMCi9H' \
    'SnhiUmNQY1pmNHN2QXl1eXhkTTBPZlNwNzJNY21XMmF0aHBrRThPemJjNXdtSStuVkJuc3g1SkUyVk5NQloKY1lBZXA5VmFLUFBJ' \
    'Yjk1c2g1SGRiTGpVbjBlUWJwMm1LaHYxWW9HR2ZxYW9BMlJoMXlCU1Fub1JNK29ORUlnMwpidk9tbmpBY1RaOGtiS09UTEtDSkpi' \
    'VEV3enI3UzdsUkRKMHNJSjJ1aEF5MTk1eWRkRGZiTTVWeTJNRGtEYkxuCjV6YldJN2hlZFV2NVVwMU0xOFVodDlxdG5xVERmbUpZ' \
    'NEo3OWgyYTBhbjVha3hCd29XVnRIR1lSY3dKL3dNQXIKMHVhaHU3aTM3ZHBpdzRnVXJMaWp3UUtDQVFFQTdJUGF0b2xCS1dLVi9m' \
    'bEVXVzMrLzRkRk9MTG42Zi9DRENsVwpFa01razlhM1FwM2U3Wkg2cSt3R25MQmY0ZmhLc1YvcDUwTTFra1pma0dzQm5obW5kem4x' \
    'aGhqclY0Yk9wSjRSCnExMU1NRkRHajN3ejVodStkZXorYVliK2pZeGl0UVh4YWRuTmpaVm9QS0F2ZWlid2V0UE00TGdMT0JVcXBK' \
    'MjcKb1Z5U1RyRGZBaEZGSVE0cFVQM1FGMzFqTWhFUWZ5VjhuSXNRcHRtZktxOEpxSWEvakJ2SE5HWXI1NnpuWmkxdgoxR251bEhq' \
    'R2k3Mm9yUUlicytPdy9ZK2IvNnd1NE5hb0tlS1h6MGJLTnd1elAybFVLbEpKOWFOaG9JcG9KdFNnCk1DbE56djNPQ3BGUXFFYUo4' \
    'RlVLT0Y4WnlZT0dKOHcwOFlPZkd3b292YldyczE5L3R3S0NBUUVBeWxaWU5hRGwKTGw3aUE3c3Q4bGdaUlVPZ212VXBwdHorUGZh' \
    'MmR3SmZzWmtGZE95b0NpSlNZVDFtMTMvbzVOYWw3OTR5M0FuaApqaFBWZ01KMlBlWEUvWkxjaURlSS9qNnJ3WkRUREJDOU9KdjA3' \
    'ckxveExHNUFWS3FnSk9RSUIxMDZQZjBwbW4yCkgxMmFjWUpCYzFOUHRPWmZhT0JQZkIrZnVEcGxiMStva2FWQkNRWHQ4TnAzUHlx' \
    'dm5HMStlRlMxcktEN2FRMUUKUWpnaElSZjZ1amFCbmJ6SGFkMVJSNzA5YUxJcDZsckpIdlpuc2xSNy9aamJPL3VBWEZzMld4WkFM' \
    'di9nQWRjMAp6MjRMeVZzUlJTb2o4T0JvRHJRUk1rc0JiMjRkaDBybEEwUFMvOCtIbE5TT0dQZFovekJBalp3UHI1TmNzNmRIClZq' \
    'SHowMTRaazg2emVRS0NBUUFlaTZqamlqWndNZHROUWJRaUdLS21QY0lpNEhnek1HVFBUVWRnZEd0MDdIWWUKbEdVR0thUkdMK1Zx' \
    'dHh5ckFuWWpFbEFUSGdyOUtUbU9YVU9JTjZmNUxmTVhyb0EyZmFLU2dCZW9HaFNNNk9HOApCajV0cVllZmswd0lOUGNMTU9aT21z' \
    'WGk5YzRtU3ZWN1h2VEN3ZVNzK0UydGVCZDYxc0Q3SWFQcDR4ckNMdldlClByeSsyQ1ZkNEduUG50SUExVk5jR0d0UGpHWktKakQ0' \
    'UWtMdEVQb01Ea3BiNmhZaGhhTWMveUZDUGF3aVlMYkQKdFdyamJUSkd1VkZTYmdtbnE0VWlaSmF6VWlCcEZLdHBFSW5GMXNTWDhx' \
    'aTZvSzhySExUMnp0OGhXVFJEVjJRVQoyVStoYS9yRW56Y0NzTVdUMFBpeWl4MExWQVJvYVpkNWFNMFVEWEZoQW9JQkFENmIzeW1o' \
    'QXFtSmxKZ2crRU92Ci9RblF0a2FjcStuRklpcWNSN09sbVdURCs4dEZXMjNmVnV4ZDZvK3VOYXR4dStEd09YNmExQjk1aGF3VkFD' \
    'K0IKQkthT0pnMUVXZkNLQmUyY1dhRzNJRVgvQkJoRVpnQlBHZmNOMUZKNjFyTUpTbDY0TXd5M1p3QW5uNTJWOTVpdQo0OUFQSk9D' \
    'MzRBQ0JiSk8rQmhzalYyN1Iyc0RuQTh4dVhVMi9jSjJQeC8yR0FMMU5CdDVueTRKT0NmcEtpRHZNCmwranVQQ3BHNEZxNWRPSUxs' \
    'eXE4TXRXUTIxOTBBdlhpc1p2cTQ3b3dReTZHUVJBSi93K3l2dFdjc0tyNnNlcGIKOHNrYk56ZXRnbEMwb3RvUEViWUdkN3k5NVBG' \
    'aER3di9oWVMyTFRQb2cyRU9ORkJZNGV0NVRIcWdkRmtvR2ZRQgpsc2tDZ2dFQVN5OUd1dTdUc0VXcXorOUpmWk9sMVF6S21pOUdG' \
    'UGZobVhKVUtBT0VYVkFrUlZLMTdQc1RBanY1CnUvOEp1TmVNZE5kdUtHaDh3d3NrU3VnNUlKN2kvSjFDZGNMNHI5a1NoZTlSM1Mw' \
    'a3NTRzYra0hUbW4rSk1CdmQKR2hLeFExa01rSi8wZUlLK3RTMGxsY05xN0gvTFdxTWZGYi9uTmU1ZjlrcEJlYURKMkQyUlNRQ2Jr' \
    'a3FqZ01xSwo4Z1BhUGorK0Y5Ylh6bi9SWDRQZ2J4WnJVUThMT0UyVEk5MGoyNzJvbTZsYmJVUnlWVWRkWllzS3RvZ29tTCtwCjJt' \
    'ekh1VGlQYm4vckZKSHZPQjdWc1hoOW44OXpYWk4wb2dCQllNNHprVThyeG55Zk9LTXYrVXI0bUtyaTdEanEKalRNUjFHaW02aTVr' \
    'eC9YTnpPSzNNQlNMZHRHK2xnPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=' \




def log(message):
    open(logFile, 'a').write(str(datetime.now()) + ' : ' + message + '\n')


class HandledError(Exception):
    def __init__(self):
        super().__init__()
